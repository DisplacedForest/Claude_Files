# Add Bug Command

## Usage
`/add-bug {bug title} [--priority {P0-P3}] [--effort {quick-win|medium|complex|unknown}]`

## Description
Adds a new bug to the tracked issues list, generates key questions to guide investigation and resolution, and creates a GitHub issue with standardized structure.

## Process
1. Add the bug title to `/docs/bugs/tracked.md`
2. Analyze the bug description to identify investigation areas
3. Generate relevant questions for bug resolution
4. Create initial structure for bug tracking
5. Assign severity and priority based on impact
6. Create a GitHub issue with standardized template

## Process Flow
1. **Bug Registration**
   - Add to `/docs/bugs/tracked.md` with timestamp
   - Generate unique bug ID (BUG-YYYY-MM-DD-XXX)
   - Set initial status as "reported"

2. **Impact Analysis**
   - Determine affected components
   - Estimate user impact scope
   - Assess business criticality
   - Calculate severity score

3. **Question Generation**
   - Reproduction steps needed
   - Environment-specific factors
   - Recent changes that might be related
   - Error messages and logs to collect
   - Workaround possibilities

4. **Initial Documentation**
   - Create bug structure in tracked.md
   - Include reporter information
   - Add initial observations
   - Set investigation priorities

5. **GitHub Issue Creation**
   - Create issue with generated template
   - Capture issue number from response
   - Update tracked.md with issue link

## Example
```
/add-bug Contact sync fails for Gmail accounts
```

This would:
- Add bug to `/docs/bugs/tracked.md` as "BUG-2024-01-15-001"
- Generate questions like:
  - Which Gmail API version is being used?
  - When did this start failing?
  - Are there specific error messages in logs?
  - Does it fail for all Gmail accounts or specific ones?
  - What are the OAuth token expiration patterns?
  - Are there recent Gmail API changes?
  - What's the current retry logic?

## Generated Structure
```markdown
## BUG-2024-01-15-001: Contact sync fails for Gmail accounts

**Status**: Ready
**Severity**: High
**Priority**: P1
**Effort**: Unknown
**Reported**: 2024-01-15 10:30 AM
**Reporter**: System

### Description
Contact sync fails for Gmail accounts

### Key Questions
1. **Reproduction**
   - Which specific Gmail accounts are affected?
   - What are the exact steps to reproduce?
   - How frequently does this occur?

2. **Environment**
   - Which environment(s) show this issue?
   - What version of the Gmail API is in use?
   - Are there any proxy or network issues?

3. **Timeline**
   - When did this issue first appear?
   - Were there recent deployments?
   - Any Gmail API announcements?

4. **Impact**
   - How many users are affected?
   - Is there data loss?
   - Are there partial failures?

5. **Workarounds**
   - Can users manually trigger sync?
   - Does re-authentication help?
   - Are other email providers working?

### Investigation Plan
- [ ] Check error logs for specific failures
- [ ] Review Gmail API changelog
- [ ] Test with fresh OAuth tokens
- [ ] Verify API quota limits
- [ ] Check network connectivity

### Related Information
- Components: ContactSync, GmailAdapter, OAuthHandler
- Similar issues: None found
- Dependencies: googleapis v105.0.0
- **GitHub Issue**: #[ISSUE_NUMBER]
```

## Severity Scoring
- **Critical**: System down, data loss, security breach
- **High**: Major feature broken, many users affected  
- **Medium**: Feature degraded, workaround available
- **Low**: Minor issue, cosmetic, few users

## GitHub Integration
Automatically creates an issue with:

### Issue Template
```markdown
## Bug Report: {title}

### üêõ Bug ID: {BUG-YYYY-MM-DD-XXX}

### üìù Description
{brief description}

### üîç Current Behavior
What actually happens:
- 

### ‚úÖ Expected Behavior
What should happen:
- 

### üîÑ Reproduction Steps
1. 
2. 
3. 

### üåç Environment
- **Environment**: [Production/Staging/Development]
- **Browser/OS**: 
- **Version**: 
- **Last Working**: 

### üìä Impact Assessment
- **Severity**: [Critical/High/Medium/Low]
- **Users Affected**: 
- **Workaround Available**: [Yes/No]
- **Effort**: [quick-win/medium/complex/unknown]

### üîç Investigation Checklist
- [ ] Review error logs
- [ ] Check recent deployments
- [ ] Verify in different environments
- [ ] Test with different user accounts
- [ ] Review related components

### üìé Additional Context
- Error messages:
- Screenshots:
- Related PRs/Issues:

### üè∑Ô∏è Labels
- bug
- priority:{P0-P3}
- severity:{critical|high|medium|low}
- effort:{quick-win|medium|complex|unknown}
- status:reported

---
*Generated by Claude Code `/add-bug` command*
```

### Command Examples
```bash
# Basic bug report (defaults to effort:unknown)
/add-bug "Login fails with special characters"

# With priority and effort
/add-bug "Payment webhook timeout" --priority P1 --effort medium

# Quick fix
/add-bug "Typo in error message" --priority P3 --effort quick-win
```

## Integration
- Links with `/fix` command for resolution
- Updates `/audit` bug metrics
- Can trigger `/test` for regression tests
- Feeds into `/release` notes
- GitHub issues link to PRs via "Fixes #123"